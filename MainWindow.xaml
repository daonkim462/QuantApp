<Window x:Class="QuantApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Stock Analysis Tool" Height="600" Width="1000">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- For buttons -->
            <RowDefinition Height="*"/>
            <!-- For DataGrid -->
            <RowDefinition Height="Auto"/>
            <!-- For status bar -->
        </Grid.RowDefinitions>

        <!-- Toolbar with buttons -->
        <ToolBar Grid.Row="0">
            <Button Name="btnGetPrice" Content="Get Stock Price" Width="120" Margin="5"/>
            <Button Name="btnCalculatePER" Content="Calculate PER" Width="120" Margin="5"/>
            <Button Name="btnGetDividend" Content="Get Dividend Rate" Width="120" Margin="5"/>
            <Button Name="btnSaveExcel" Content="Save to Excel" Width="120" Margin="5"/>
        </ToolBar>

        <!-- DataGrid to show stock data -->
        <DataGrid Grid.Row="1" 
          Name="stockDataGrid"
          AutoGenerateColumns="False"
          CanUserAddRows="False">
            <DataGrid.Columns>
                <!-- Checkbox column -->
                <DataGridCheckBoxColumn Header="✓" 
                               Binding="{Binding IsChecked}"
                               Width="30"/>

                <!-- Last Checked -->
                <DataGridTextColumn Header="Last Checked" 
                           Binding="{Binding LastCheckedDisplay}" 
                           Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                    <Setter Property="Foreground" Value="Green"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IsChecked}" Value="False">
                                    <Setter Property="Foreground" Value="Gray"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- Stock columns -->
                <DataGridTextColumn Header="Code" Binding="{Binding stock_code}" Width="80"/>
                <DataGridTextColumn Header="Company" Binding="{Binding corp_name}" Width="200"/>
                <DataGridTextColumn Header="PER" Binding="{Binding PER, StringFormat=F2}" Width="60"/>
                <DataGridTextColumn Header="DPR" Binding="{Binding DPR, StringFormat=F2}" Width="60"/>
                <DataGridTextColumn Header="Market Cap" Binding="{Binding market_cap, StringFormat=N0}" Width="120"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Status bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Name="txtStatus" Text="Ready"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>